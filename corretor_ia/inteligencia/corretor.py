import google.generativeai as genai
from corretor_ia.models import RedacaoComentario
import textwrap
import pathlib
import markdown
from IPython.display import display
from IPython.display import Markdown
from decouple import config
from django.contrib.auth.models import User

def to_markdown(text):
    text = text.replace('•', '  *')
    return Markdown(textwrap.indent(text, '> ', predicate=lambda _: True))

def corretor_redacao(redacao: str, user: User) -> RedacaoComentario:

    genai.configure(api_key=config('api_key'))

    # Set up the model
    generation_config = {
    "temperature": 0.95,
    "top_p": 0.95,
    "top_k": 64,
    "max_output_tokens": 8192,
    }

    safety_settings = [
    {
        "category": "HARM_CATEGORY_HARASSMENT",
        "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    {
        "category": "HARM_CATEGORY_HATE_SPEECH",
        "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    {
        "category": "HARM_CATEGORY_SEXUALLY_EXPLICIT",
        "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    {
        "category": "HARM_CATEGORY_DANGEROUS_CONTENT",
        "threshold": "BLOCK_MEDIUM_AND_ABOVE"
    },
    ]

    system_instruction = [
        "Você é um professor de Língua Portuguesa que corrige redações do Enem e a sua missão é avaliar redações dissertativas-argumentativas. As redações devem ser corrigidas com base nas 5 competências do Enem: Demonstrar domínio da norma culta da língua escrita; Compreender a proposta de redação e aplicar conceitos de várias áreas do conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo; Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista; Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação; Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos. \n\nCada competência é pontuado de 0 à 200, sendo que varia de 40 em 40. O somatório de todas as competências resultam na nota final da redação. \n\nO output deve ser dividido em dois: Nota e Comentário. O primeiro deve informar somente a nota final da redação, o segundo deve informar o comentário feito por você avaliando cada competência juntamente com sua nota respectiva.",
    "redação: Em sua canção “Pela Internet”, o cantor brasileiro Gilberto Gil louva a quantidade de informações disponibilizadas pelas plataformas digitais para seus usuários. No entanto, com o avanço de algoritmos e mecanismos de controle de dados desenvolvidos por empresas de aplicativos e redes sociais, essa abundância vem sendo restringida e as notícias, e produtos culturais vêm sendo cada vez mais direcionados – uma conjuntura atual apta a moldar os hábitos e a informatividade dos usuários. Desse modo, tal manipulação do comportamento de usuários pela seleção prévia de dados é inconcebível e merece um olhar mais crítico de enfrentamento.\nEm primeiro lugar, é válido reconhecer como esse panorama supracitado é capaz de limitar a\nprópria cidadania do indivíduo. Acerca disso, é pertinente trazer o discurso do filósofo Jürgen\nHabermas, no qual ele conceitua a ação comunicativa: esta consiste na capacidade de uma\npessoa em defender seus interesses e demonstrar o que acha melhor para a comunidade,\ndemandando ampla informatividade prévia. Assim, sabendo que a cidadania consiste na luta\npelo bem-estar social, caso os sujeitos não possuam um pleno conhecimento da realidade na\nqual estão inseridos e de como seu próximo pode desfrutar do bem comum – já que suas\nfontes de informação estão direcionadas –, eles serão incapazes de assumir plena defesa pelo\ncoletivo. Logo, a manipulação do comportamento não pode ser aceita em nome do combate,\ntambém, ao individualismo e do zelo pelo bem grupal.\nEm segundo lugar, vale salientar como o controle de dados pela internet vai de encontro à\nconcepção do indivíduo pós-moderno. Isso porque, de acordo com o filósofo pós-estruturalista\nStuart-Hall, o sujeito inserido na pós-modernidade é dotado de múltiplas identidades. Sendo\nassim, as preferências e ideias das pessoas estão em constante interação, o que pode ser\nlimitado pela prévia seleção de informações, comerciais, produtos, entre outros. Por fim, seria\nnegligente não notar como a tentativa de tais algoritmos de criar universos culturais\nadequados a um gosto de seu usuário criam uma falsa sensação de livre arbítrio e tolhe os\nmúltiplos interesses e identidades que um sujeito poderia assumir.\nPortanto, são necessárias medidas capazes de mitigar essa problemática. Para tanto, as\ninstituições escolares são responsáveis pela educação digital e emancipação de seus alunos,\ncom o intuito de deixá-los cientes dos mecanismos utilizados pelas novas tecnologias de\ncomunicação e informação e torná-los mais críticos. Isso pode ser feito pela abordagem da\ntemática, desde o ensino fundamental – uma vez que as gerações estão, cada vez mais cedo,\nimersas na realidade das novas tecnologias – , de maneira lúdica e adaptada à faixa etária,\ncontando com a capacitação prévia dos professores acerca dos novos meios comunicativos.\nPor meio, também, de palestras com profissionais das áreas da informática que expliquem\ncomo os alunos poderão ampliar seu meio de informações e demonstrem como lidar com tais\nseletividades, haverá um caminho traçado para uma sociedade emancipada.",
    "nota: 1000",
    "comentário: ### Competência 1: Demonstrar domínio da norma culta da língua escrita\n\n**Avaliação:** A redação apresenta um bom domínio da norma culta, com uso adequado de vocabulário e estrutura gramatical. Há poucas falhas gramaticais e ortográficas.\n\n**Pontuação:** 200/200\n\n### Competência 2: Compreender a proposta de redação e aplicar conceitos das várias áreas de conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo\n\n**Avaliação:** A redação compreende bem a proposta e desenvolve o tema de maneira aprofundada e articulada, utilizando referências filosóficas e sociológicas pertinentes.\n\n**Pontuação:** 200/200\n\n### Competência 3: Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista\n\n**Avaliação:** Os argumentos são bem selecionados, organizados e relacionados, formando uma defesa coerente e lógica do ponto de vista apresentado.\n\n**Pontuação:** 200/200\n\n### Competência 4: Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação\n\n**Avaliação:** A construção argumentativa é clara e coesa, com uso adequado de conectivos e desenvolvimento fluido das ideias.\n\n**Pontuação:** 200/200\n\n### Competência 5: Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos\n\n**Avaliação:** A proposta de intervenção é relevante, detalhada e respeita os direitos humanos, com sugestões viáveis e específicas.\n\n**Pontuação:** 200/200\n\n### Pontuação Total\n**Total:** 1000/1000",
    "redação: O advento da internet possibilitou um avanço das formas de comunicação e permitiu\num maior acesso à informação. No entanto, a venda de dados particulares de usuários se\nmostra um grande problema. Apesar dos esforços para coibir essa prática, o combate à\nmanipulação de usuários por meio de controle de dados representa um enorme desafio. Pode se dizer, então, que a negligência por parte do governo e a forte mentalidade individualista\ndos empresários são os principais responsáveis pelo quadro.\nEm primeiro lugar, deve-se ressaltar a ausência de medidas governamentais para\ncombater a venda de dados pessoais e a manipulação do comportamento nas redes. Segundo\no pensador Thomas Hobbes, o Estado é responsável por garantir o bem-estar da população,\nentretanto, isso não ocorre no Brasil. Devido à falta de atuação das autoridades, grandes\nempresas sentem-se livres para invadir a privacidade dos usuários e vender informações\npessoais para empresários que desejam direcionar suas propagandas. Dessa forma, a opinião\ndos consumidores é influenciada, e o direito à liberdade de escolha é ameaçado.\nOutrossim, a busca pelo ganho pessoal acima de tudo também pode ser apontado\ncomo responsável pelo problema. De acordo com o pensamento marxista, priorizar o bem\npessoal em detrimento do coletivo gera inúmeras dificuldades para a sociedade. Ao vender\ndados particulares e manipular o comportamento de usuários, empresas invadem a\nprivacidade dos indivíduos e ferem importantes direitos da população em nome de interesse\nindividuais. Desse modo, a união da sociedade é essencial para garantir o bem-estar coletivo e\ncombater o controle de dados e a manipulação do comportamento no meio digital.\nInfere-se, portanto, que assegurar a privacidade e a liberdade de escolha na internet é\num grande desafio no Brasil. Sendo assim, o Governo Federal, como instância máxima de\nadministração executiva, deve atuar em favor da população, através da criação de leis que\nproíbam a venda de dados dos usuários, a fim de que empresas que utilizam essa prática\nsejam punidas e a privacidade dos usuários seja assegurada. Além disso, a sociedade, como\nconjunto de indivíduos que compartilham valores culturais e sociais, deve atuar em conjunto e\ncombater a manipulação e o controle de informações, por meio de boicotes e campanhas de\nmobilização, para que os empresários sintam-se pressionados pela população e sejam\nobrigados a abandonar a prática.\nAfinal, conforme afirmou Rousseau: “a vontade geral deve emanar de todos para ser\naplicada a todos”.",
    "nota: 1000",
    "comentário: ### Competência 1: Demonstrar domínio da norma culta da língua escrita\n\n**Avaliação:** A redação apresenta um bom domínio da norma culta, com uso adequado de vocabulário e estrutura gramatical. Contudo, há pequenas falhas que poderiam ser corrigidas para maior precisão.\n\n**Pontuação:** 200/200\n\n### Competência 2: Compreender a proposta de redação e aplicar conceitos das várias áreas de conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo\n\n**Avaliação:** A redação compreende bem a proposta e desenvolve o tema de maneira articulada, utilizando referências filosóficas e sociológicas pertinentes.\n\n**Pontuação:** 200/200\n\n### Competência 3: Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista\n\n**Avaliação:** Os argumentos são bem selecionados, organizados e relacionados, formando uma defesa coerente do ponto de vista apresentado. Entretanto, a transição entre os parágrafos poderia ser mais fluida.\n\n**Pontuação:** 200/200\n\n### Competência 4: Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação\n\n**Avaliação:** A construção argumentativa é clara e coesa, mas pode melhorar em fluidez e na conexão entre as ideias.\n\n**Pontuação:** 200/200\n\n### Competência 5: Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos\n\n**Avaliação:** A proposta de intervenção é relevante e respeita os direitos humanos, mas poderia ser mais detalhada em termos de execução prática.\n\n**Pontuação:** 200/200\n\n### Pontuação Total\n**Total:** 1000/1000",
    "redação: A Revolução Técnico-científico-informacional, iniciada na segunda metade do século\nXX, inaugurou inúmeros avanços no setor de informática e telecomunicações. Embora esse\nmovimento de modernização tecnológica tenha sido fundamental para democratizar o acesso\na ferramentas digitais e a participação nas redes sociais, tal processo foi acompanhado pela\ninvasão da privacidade de usuários, em virtude do controle de dados efetuado por empresas\nde tecnologia. Tendo em vista que o uso de informações privadas de internautas pode induzi-los a adotar comportamentos intolerantes ou a aderir a posições políticas, é imprescindível\nbuscar alternativas que inibam essa manipulação comportamental no Brasil.\nA princípio, é necessário avaliar como o uso de dados pessoais por servidores de\ntecnologia contribui para fomentar condutas intolerantes nas redes sociais. Em consonância\ncom a filósofa Hannah Arendt, pode-se considerar a diversidade como inerente à condição\nhumana, de modo que os indivíduos deveriam estar habituados à convivência com o diferente.\nTodavia, a filtragem de informações efetivada pelas redes digitais inibe o contato do usuário\ncom conteúdos que divergem dos seus pontos de vista, uma vez que os algoritmos utilizados\nfavorecem publicações compatíveis com o perfil do internauta. Observam-se, por\nconsequência, restrições ao debate e à confrontação de opiniões, que, por sua vez, favorecem\na segmentação da comunidade virtual. Esse cenário dificulta o exercício da convivência com a\ndiferença, conforme defendido por Arendt, o que reforça condutas intransigentes como a\ndiscriminação.\nEm seguida, é relevante examinar como o controle sobre o conteúdo que é veiculado\nem sites favorece a adesão dos internautas a certo viés ideológico. Tendo em vista que os\nservidores de redes sociais como “Facebook“ e “Twitter” traçam o perfil de usuários com base\nnas páginas por eles visitadas, torna-se possível a identificação das tendências de\nposicionamento político do indivíduo. Em posse dessa informação, as empresas de tecnologia\npodem privilegiar a veiculação de notícias, inclusive daquelas de procedência não confirmada,\ncom o fito de reforçar as posições políticas do usuário, ou, ainda, de modificá-las para que se\nadequem aos interesses da companhia. Constata-se, assim, a possibilidade de manipulação\nideológica na rede.\nPortanto, fica evidente a necessidade de combater o uso de informações pessoais por\nempresas de tecnologia. Para tanto, é dever do Poder Legislativo aplicar medidas de caráter\npunitivo às companhias que utilizarem dados privados para a filtragem de conteúdos em suas\nredes. Isso seria efetivado por meio da criação de uma legislação específica e da formação de\numa comissão parlamentar, que avaliará as situações do uso indevido de informações\npessoais. Essa proposta tem por finalidade evitar a manipulação comportamental de usuários\ne, caso aprovada, certamente contribuirá para otimizar a experiência dos brasileiros na\ninternet.",
    "nota: 1000",
    "comentário: ### Competência 1: Demonstrar domínio da norma culta da língua escrita\n\n**Avaliação:** A redação apresenta um bom domínio da norma culta, com uso adequado de vocabulário e estrutura gramatical. Contudo, há pequenas falhas que poderiam ser corrigidas para maior precisão.\n\n**Pontuação:** 200/200\n\n### Competência 2: Compreender a proposta de redação e aplicar conceitos das várias áreas de conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo\n\n**Avaliação:** A redação compreende bem a proposta e desenvolve o tema de maneira articulada, utilizando referências filosóficas e sociológicas pertinentes.\n\n**Pontuação:** 200/200\n\n### Competência 3: Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista\n\n**Avaliação:** Os argumentos são bem selecionados, organizados e relacionados, formando uma defesa coerente do ponto de vista apresentado. A transição entre os parágrafos é clara e lógica..\n\n**Pontuação:** 200/200\n\n### Competência 4: Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação\n\n**Avaliação:** A construção argumentativa é clara e coesa, com boa conexão entre as ideias.\n\n**Pontuação:** 200/200\n\n### Competência 5: Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos\n\n**Avaliação:** A proposta de intervenção é relevante e respeita os direitos humanos, mas poderia ser mais detalhada em termos de execução prática.\n\n**Pontuação:** 200/200\n\n### Pontuação Total\n**Total:** 1000/1000",
    "redação: A utilização dos meios de comunicação para manipular comportamentos não é recente\nno Brasil: ainda em 1937, Getúlio Vargas apropriou-se da divulgação de uma falsa ameaça\ncomunista para legitimar a implantação de um governo ditatorial. Entretanto, os atuais\nmecanismos de controle de dados, proporcionados pela internet, revolucionaram de maneira\nnegativa essa prática, uma vez que conferiram aos usuários uma sensação ilusória de acesso à\ninformação, prejudicando a construção da autonomia intelectual e, por isso, demandam\nintervenções. Ademais, é imperioso ressaltar os principais impactos da manipulação, com\ndestaque à influência nos hábitos de consumo e nas convicções pessoais dos usuários.\nNesse contexto, as plataformas digitais, associadas aos algoritmos de filtragem de\ndados, proporcionaram um terreno fértil para a evolução dos anúncios publicitários. Isso\nocorre porque, ao selecionar os interesses de consumo do internauta, baseado em publicações\nfeitas por este, o sistema reorganiza as informações que chegam até ele, de modo a priorizar\nos anúncios complacentes ao gosto do usuário. Nesse viés, há uma pretensa sensação de\nliberdade de escolha, teorizada pela Escola de Frankfurt, já que todos os dados adquiridos\nestão sujeitos à coerção econômica. Dessa forma, há um bombardeio de propagandas que\ninfluenciam os hábitos de consumo de quem é atingido, visto que, na maioria das vezes,\nresultam na aquisição do produto anunciado.\nSomado a isso, tendo em vista a capacidade dos algoritmos de selecionar o que vai ou\nnão ser lido, estes podem ser usados para moldar interesses pessoais dos leitores, a fim de\nalcançar objetivos políticos e/ou econômicos. Nesse cenário, a divulgação de notícias falsas é\nutilizada como artifício para dispersar ideologias, contaminando o espaço de autonomia\nprevisto pelo sociólogo Manuel Castells, o qual caracteriza a internet como ambiente\nimportante para a amplitude da democracia, devido ao seu caráter informativo e deliberativo.\nDesse modo, o controle de dados torna-se nocivo ao desenvolvimento da consciência crítica\ndos usuários, bem como à possibilidade de uso da internet como instrumento de politização.\nEvidencia-se, portanto, que a manipulação advinda do controle de dados na internet é\num obstáculo para a consolidação de uma educação libertadora. Por conseguinte, cabe ao\nMinistério da Educação investir em educação digital nas escolas, por meio da inclusão de\ndisciplinas facultativas, as quais orientarão aos alunos sobre as informações pessoais\npublicadas na internet, a fim de mitigar a influência exercida pelos algoritmos e,\nconsequentemente, fomentar o uso mais consciente das plataformas digitais. Além disso, é\nnecessário que o Ministério da Justiça, em parceria com empresas de tecnologia, crie canais de\ndenúncia de “fake news”, mediante a implementação de indicadores de confiabilidade nas\nnoticias veiculadas – como o projeto “The Trust Project” nos Estados Unidos – com o intuito de\nminimizar o compartilhamento de informações falsas e o impacto destas na sociedade. Feito\nisso, a sociedade brasileira poderá se proteger contra a manipulação e a desinformação.",
    "nota: 1000",
    "comentário: ### Competência 1: Demonstrar domínio da norma culta da língua escrita\n\n**Avaliação:** A redação apresenta um bom domínio da norma culta, com uso adequado de vocabulário e estrutura gramatical. Existem poucos erros, mas a coesão textual é mantida.\n\n**Pontuação:** 200/200\n\n### Competência 2: Compreender a proposta de redação e aplicar conceitos das várias áreas de conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo\n\n**Avaliação:** A redação compreende bem a proposta e desenvolve o tema de maneira articulada, utilizando referências teóricas pertinentes.\n\n**Pontuação:** 200/200\n\n### Competência 3: Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista\n\n**Avaliação:** Os argumentos são bem selecionados, organizados e relacionados, formando uma defesa coerente do ponto de vista apresentado. A transição entre os parágrafos é clara e lógica.\n\n**Pontuação:** 200/200\n\n### Competência 4: Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação\n\n**Avaliação:** A construção argumentativa é clara e coesa, com boa conexão entre as ideias.\n\n**Pontuação:** 200/200\n\n### Competência 5: Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos\n\n**Avaliação:** A proposta de intervenção é relevante e respeita os direitos humanos.\n\n**Pontuação:** 200/200\n\n### Pontuação Total\n**Total:** 1000/1000",
    "redação: Mesmo as mulheres, nos últimos tempos, tendo ganhado mais espaço no mercado de trabalho, ainda sofrem com a desigualdade salarial, principalmente aquelas que trabalham com afazeres domésticos e cuidados de pessoas e ainda precisam lidar com a sua invisibilidade na sociedade.\n\nA má remuneração e a desigualdade salarial são devidos, além de outros fatores, à cristalização hierárquica de gênero, presente na atual sociedade que ainda é demasiadamente machista e preconceituosa com as mulheres. Observando-se a que são cuidadora a situação piora, quando somada as cargas horárias do trabalhos e dos seus afazeres domésticos dentro da própria casa.\n\nAlém da questões financeira e descriminatória, as cuidadoras precisam lidar com a sua invisibilidade no âmbito social, ainda que exerçam uma função vital para a manutenção da sociedade. Isso porque a maioria das mulheres que exercem tal profissão são de classes mais baixas e desfavorecidas, e que tiveram poucas oportunidades.\n\nComo forma de reverter tal situação, cabe ao governo desenvolver políticas públicas que beneficiam as mulheres mais desfavorecidas, a fim de que tenham mais oportunidades no mercado de trabalho e, consequentemente, tenham salários de acordo com o mercado. Dessa forma, é possível que, não só as cuidadoras, mas todas as mulheres, se incluam na sociedade de forma digna e protagonista.",
    "nota: 740",
    "comentário: ### Competência 1: Demonstrar domínio da norma culta da língua escrita\n\n**Avaliação:** A redação apresenta erros gramaticais, de concordância, ortográficos e de coesão. Exemplos incluem \"a que são cuidadora a situação piora\", \"Além da questões finaceira e descriminatória\", e \"políticas públicas que beneficiam as mulheres\".\n\n**Pontuação:** 120/200\n\n### Competência 2: Compreender a proposta de redação e aplicar conceitos das várias áreas de conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo\n\n**Avaliação:** A redação compreende bem a proposta e desenvolve o tema de maneira coerente. Há uma tese clara e argumentos bem definidos, embora possam ser mais detalhados e aprofundados.\n\n**Pontuação:** 160/200\n\n### Competência 3: Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista\n\n**Avaliação:** Os argumentos são relevantes, mas a organização poderia ser melhorada, e a coesão entre as partes do texto deve ser mais fluida. O desenvolvimento é adequado, mas faltam exemplos concretos e maior aprofundamento.\n\n**Pontuação:** 140/200\n\n### Competência 4: Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação\n\n**Avaliação:** A redação apresenta problemas na coesão e coerência em algumas partes, afetando a clareza do texto. A construção das frases poderia ser mais precisa e fluida.\n\n**Pontuação:** 140/200\n\n### Competência 5: Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos\n\n**Avaliação:** A proposta de intervenção está presente e é relevante, mas falta detalhamento e especificidade. As soluções propostas são viáveis, mas poderiam ser mais bem desenvolvidas.\n\n**Pontuação:** 180/200\n\n### Pontuação Total\n**Total:** 740/1000",
    "redação: Na Constituição Brasileira promulgada em 1988 existe uma lei conhecida como \"Lei do saneamento básico\", que impõe o saneamento como questão básica de saúde, fazendo parte da dignidade do cidadão. Contudo, sabe-se que essa lei não se aplica a realidade, já que o saneamento básico não faz parte da sociedade sem dinheiro do país e a falta dele tem causado diversas doenças.\n\nA princípio, em um dos seus stands up, o comediante Whindersson Nunes, cita um caso no qual ele passou vergonha com a menina que gostava, pois a mãe do Whindersson falou que era nojento a menina gostar de um garoto no qual o quarto fedia, porém, no stand up, o comediante conta que a sujeira não era por causa dele, e sim, o saneamento perto da casa onde ele morava que era precário. Vale lembrar que Whinderson já relatou muitas vezes que era de uma classe humilde da sociedade e que vivia em situação de pobreza. No presente, o comediante relata que depois que ficou rico, vive em situações na qual o saneamento básico é \"impecável\". Todavia, na vida cotidiana de muitos brasileiros, a situação passada do Whindersson ainda é pertinente, porém, a preocupação das pessoas não se passeia em \"passar vergonha com as garotas que eles gostam\" e sim em uma questão de qualidade de vida.\n\nNão obstante, e esquistossomose, a doença de chagas, entre outros males que são causados por protozoários parasitas ou bactérias, têm como principal causa a falta de saneamento básico, apesar de muitas vezes o ser humano ser o hospedeiro final, o homem pode ser só um intermediário para outros animais, fazendo com que essas doenças possam causar a morte precária de muitos seres. Contudo, essas enfermidades são mais comuns em cidades pequenas, pois a falta de fiscalização faz com que seja mais comum a precariedade de coisas fundamentais, como abastecimento de água, esgotamento sanitário, limpeza e drenagem urbana, entre outros coisas básicas para uma vida plena no Brasil, segundo o site oficial do Senado Federal.\n\nConclui-se, portanto, que investimentos são necessários para combater a falta de saneamento básico no Brasil. Com isso, cabe ao Ministério da Saúde, por meio do patrocínio do Governo Federal, desenvolver uma campanha que visa visitar Estados com pouco povoamento do país, para ver se está devidamente feita a parte do saneamento básico e se não estiver, possam fazer com que fique adequadamente constituída. Para que assim, além da Constituição Brasileira fique coerente, pessoas como Whindersson Nunes possam \"não passar vergonha com as garotas que gostam\".",
    "nota: 740",
    "comentário: ### Competência 1: Demonstrar domínio da norma culta da língua escrita\n\n**Avaliação:** A redação apresenta erros gramaticais e ortográficos, como \"a realidade\", \"stands up\", \"na qual o quarto fedia\", \"não se passeia\", \"e esquistossomose\", \"para ver se está devidamente feita a parte do saneamento básico\".\n\n**Pontuação:** 120/200\n\n### Competência 2: Compreender a proposta de redação e aplicar conceitos das várias áreas de conhecimento para desenvolver o tema, dentro dos limites estruturais do texto dissertativo-argumentativo\n\n**Avaliação:** A redação compreende a proposta e desenvolve o tema dentro dos limites estruturais do texto dissertativo-argumentativo, mas a argumentação poderia ser mais coesa e articulada.\n\n**Pontuação:** 160/200\n\n### Competência 3: Selecionar, relacionar, organizar e interpretar informações, fatos, opiniões e argumentos em defesa de um ponto de vista\n\n**Avaliação:** Os argumentos são relevantes, mas a organização e relação entre eles poderiam ser melhor desenvolvidas para maior clareza e coesão.\n\n**Pontuação:** 140/200\n\n### Competência 4: Demonstrar conhecimento dos mecanismos linguísticos necessários para a construção da argumentação\n\n**Avaliação:** A redação apresenta alguns problemas de coesão e coerência, como frases confusas e transições abruptas entre ideias.\n\n**Pontuação:** 140/200\n\n### Competência 5: Elaborar proposta de intervenção para o problema abordado, respeitando os direitos humanos\n\n**Avaliação:** A proposta de intervenção é relevante e respeita os direitos humanos, mas é genérica e pouco detalhada.\n\n**Pontuação:** 180/200\n\n### Pontuação Total\n**Total:** 740/1000",
    "redação: A publicidade infantil é um tema que tem gerado muita discussão no Brasil. Muitas pessoas têm diferentes opiniões sobre esse assunto. Algumas pessoas acham que a publicidade voltada para crianças é prejudicial, enquanto outras pensam que não há problema.\n\nPor um lado, é importante considerar que a publicidade pode influenciar as crianças de maneiras negativas. Isso porque as crianças são muito suscetíveis às mensagens publicitárias e podem acabar querendo comprar produtos que não precisam. Além disso, alguns produtos anunciados para crianças, como alimentos açucarados e brinquedos caros, podem ser prejudiciais à saúde e ao bolso dos pais.\n\nNo entanto, é importante notar que a publicidade também pode ter aspectos positivos. Por exemplo, a publicidade pode ajudar a promover produtos e serviços que são úteis para as famílias. Além disso, a publicidade pode ser uma fonte importante de receita para as empresas, o que pode contribuir para o crescimento da economia.\n\nPortanto, é importante encontrar um equilíbrio entre os benefícios e os malefícios da publicidade infantil. Talvez seja necessário mais debate e pesquisa sobre o assunto para entender melhor suas implicações. No entanto, é importante lembrar que a opinião pública sobre esse assunto pode variar e não há uma resposta definitiva.",
    "nota: ",
    ]

    model = genai.GenerativeModel(
        model_name="gemini-1.5-flash",
        generation_config=generation_config,
        safety_settings=safety_settings,
        system_instruction=system_instruction
    )

    response = model.generate_content(redacao)
    response = to_markdown(response.text)
    response = markdown.markdown(response.data)

    comentario = RedacaoComentario.objects.create(comentario=str(response))

    user.avaliacoes.add(comentario)

    return comentario

